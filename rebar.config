{erl_opts, [debug_info
           ,{parse_transform, lager_transform}
           ]}.

{deps, [{lager, "3.5.1"},
        {lager_syslog, {git, "https://github.com/basho/lager_syslog.git",{tag, "3.0.3"}}},
        {folsom, "0.8.5"}
       ]}.

{cover_enabled, true}.
{cover_excl_mods, [server_sup
                  ,db_sup]}.

{relx, [{release,
         {acme, "0.0.1"},
         [
          {runtime_tools, load},
          lager,
          lager_syslog,
          {mnesia, load},
          common,
          db,
          server,
          singleton
         ]
        },
        {dev_mode, false},
        {include_erts, true},
        {extended_start_script, true},
        {sys_config, "config/sys.config"},
        {vm_args, "config/vm.args"}
       ]}.

{overrides, [
   %%
   %% required to assemble native library
   {override, syslog, [
      {plugins, [pc]},
      {artifacts, ["priv/syslog_drv.so"]},
      {provider_hooks, [
         {post, [
            {compile, {pc, compile}},
            {clean, {pc, clean}}
         ]}
      ]}
   ]}
]}.

{plugins, [rebar3_run, rebar3_hex]}.
